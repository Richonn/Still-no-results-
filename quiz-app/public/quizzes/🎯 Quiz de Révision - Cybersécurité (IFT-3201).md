# Quel est le numéro de protocole IP pour TCP ?
- [ ] 1
- [x] 6
- [ ] 17
- [ ] 89
---

# Quelle est la taille maximale d'un paquet IP (Total Length) ?
- [ ] 1500 octets
- [ ] 9000 octets
- [x] 65535 octets
- [ ] 4096 octets
---

# Dans la fragmentation IP, l'offset est exprimé en unités de :
- [ ] 1 octet
- [ ] 4 octets
- [x] 8 octets
- [ ] 16 octets
---

# Quel protocole permet de traduire une adresse IP en adresse MAC ?
- [ ] ICMP
- [x] ARP
- [ ] RARP
- [ ] DNS
---

# ARP fonctionne uniquement :
- [x] Sur le réseau local
- [ ] À travers les routeurs
- [ ] Sur Internet
- [ ] Sur les réseaux WAN
---

# Un message ICMP de type 8 correspond à :
- [ ] Echo Reply
- [x] Echo Request (Ping)
- [ ] Destination Unreachable
- [ ] Time Exceeded
---

# Un message ICMP de type 3 code 3 signifie :
- [ ] Réseau inaccessible
- [ ] Hôte inaccessible
- [x] Port inaccessible
- [ ] TTL expiré
---

# Quelle commande permet d'afficher le cache ARP ?
- [ ] ifconfig
- [x] arp -a
- [ ] netstat -r
- [ ] route print
---

# Le protocole UDP utilise le port de protocole IP :
- [ ] 1
- [ ] 6
- [x] 17
- [ ] 89
---

# La taille de l'en-tête UDP est de :
- [ ] 20 octets
- [ ] 16 octets
- [ ] 12 octets
- [x] 8 octets
---

# Le three-way handshake TCP comprend dans l'ordre :
- [ ] ACK, SYN, SYN/ACK
- [x] SYN, SYN/ACK, ACK
- [ ] SYN, ACK, SYN/ACK
- [ ] SYN/ACK, SYN, ACK
---

# Le champ Window Size dans TCP sert à :
- [ ] Identifier la version TCP
- [x] Contrôler le flux de données
- [ ] Vérifier l'intégrité
- [ ] Fragmenter les paquets
---

# Quel flag TCP indique la fin d'un flux de données ?
- [ ] RST
- [ ] SYN
- [x] FIN
- [ ] PSH
---

# Pour un masque /24, combien d'hôtes utilisables ?
- [ ] 256
- [x] 254
- [ ] 255
- [ ] 253
---

# Quelle plage appartient aux adresses privées ?
- [x] 10.0.0.0/8
- [ ] 172.32.0.0/16
- [ ] 192.167.1.0/24
- [ ] 11.0.0.0/8
---

# Quelle est la durée approximative de reconnaissance dans une cyberattaque ?
- [ ] 10% du temps
- [ ] 50% du temps
- [x] 90% du temps
- [ ] 25% du temps
---

# Quel outil permet de trouver des sous-domaines automatiquement ?
- [ ] nmap
- [x] Sublist3r
- [ ] Wireshark
- [ ] tcpdump
---

# Shodan est surnommé :
- [ ] Le moteur de recherche invisible
- [x] Le moteur de recherche le plus terrifiant d'Internet
- [ ] Le Google du Dark Web
- [ ] Le scanner ultime
---

# Quelle requête Google trouve des fichiers PDF sur un site ?
- [ ] site:exemple.com pdf
- [x] site:exemple.com filetype:pdf
- [ ] site:exemple.com type:pdf
- [ ] inurl:pdf site:exemple.com
---

# L'opérateur Google "intitle:" permet de chercher :
- [ ] Dans les URLs
- [x] Dans les titres de pages
- [ ] Dans le texte de la page
- [ ] Dans les méta-descriptions
---

# Quel outil permet d'extraire des métadonnées de fichiers ?
- [ ] theHarvester
- [ ] nmap
- [x] FOCA
- [ ] Maltego
---

# Le fichier robots.txt indique :
- [ ] Les ports ouverts
- [x] Les pages à ne pas indexer
- [ ] Les vulnérabilités
- [ ] Les adresses IP
---

# Quelle commande WHOIS affiche les informations d'un domaine ?
- [ ] dns exemple.com
- [ ] nslookup exemple.com
- [x] whois exemple.com
- [ ] host exemple.com
---

# Quel type d'enregistrement DNS contient les serveurs de messagerie ?
- [ ] A
- [ ] CNAME
- [x] MX
- [ ] TXT
---

# La commande "dig AXFR" permet de :
- [ ] Tester la latence DNS
- [x] Effectuer un zone transfer
- [ ] Résoudre une adresse IP
- [ ] Afficher le cache DNS
---

# Quel outil permet de créer une wordlist à partir d'un site web ?
- [ ] FOCA
- [x] cewl
- [ ] theHarvester
- [ ] Maltego
---

# InSpy est spécialisé pour collecter des informations depuis :
- [ ] Facebook
- [ ] Twitter
- [x] LinkedIn
- [ ] Instagram
---

# Quelle technique d'ingénierie sociale consiste à fouiller les poubelles ?
- [ ] Shoulder surfing
- [ ] Phishing
- [x] Dumpster diving
- [ ] Tailgating
---

# theHarvester utilise comme sources (plusieurs réponses possibles) :
- [x] Google
- [x] LinkedIn
- [x] Shodan
- [ ] Wireshark
---

# Maltego est décrit comme :
- [x] Le couteau suisse du footprinting
- [ ] Un scanner de ports
- [ ] Un analyseur de paquets
- [ ] Un outil de cracking
---

# Quelle commande nmap effectue un TCP SYN scan ?
- [ ] nmap -sT
- [x] nmap -sS
- [ ] nmap -sU
- [ ] nmap -sP
---

# Un scan TCP connect complète le three-way handshake :
- [x] Vrai
- [ ] Faux
---

# Quel scan est le plus furtif ?
- [ ] TCP Connect (-sT)
- [x] TCP SYN (-sS)
- [ ] UDP scan (-sU)
- [ ] Ping scan (-sP)
---

# Un port qui ne répond pas à un paquet FIN est probablement :
- [x] Ouvert
- [ ] Fermé
- [ ] Filtré
- [ ] Indéterminé
---

# Le scan Xmas Tree active les flags :
- [ ] SYN + ACK + FIN
- [x] FIN + URG + PSH
- [ ] SYN + RST + FIN
- [ ] ACK + PSH + URG
---

# L'option nmap -O permet de :
- [ ] Scanner les ports UDP
- [x] Détecter le système d'exploitation
- [ ] Effectuer un scan rapide
- [ ] Utiliser des decoys
---

# Le TTL initial de Linux est typiquement :
- [ ] 32
- [x] 64
- [ ] 128
- [ ] 255
---

# Le TTL initial de Windows est typiquement :
- [ ] 32
- [ ] 64
- [x] 128
- [ ] 255
---

# Quel outil effectue de la détection passive d'OS ?
- [ ] nmap -O
- [ ] queso
- [x] p0f
- [ ] hping3
---

# fping envoie des pings :
- [ ] Séquentiellement
- [x] En parallèle
- [ ] Aléatoirement
- [ ] Sur demande
---

# L'option nmap -sU scanne les ports :
- [ ] TCP
- [x] UDP
- [ ] Les deux
- [ ] Aucun des deux
---

# Un scan UDP est généralement :
- [ ] Plus rapide qu'un scan TCP
- [x] Plus lent qu'un scan TCP
- [ ] À la même vitesse
- [ ] Impossible à effectuer
---

# L'option nmap -T4 correspond au niveau :
- [ ] Paranoid
- [ ] Sneaky
- [ ] Normal
- [x] Aggressive
---

# Le port 22 correspond généralement au service :
- [ ] HTTP
- [x] SSH
- [ ] FTP
- [ ] SMTP
---

# Le port 443 correspond généralement au service :
- [ ] HTTP
- [x] HTTPS
- [ ] SSH
- [ ] DNS
---

# Traceroute utilise principalement :
- [x] Des valeurs TTL incrémentales
- [ ] Des requêtes DNS
- [ ] Des paquets UDP aléatoires
- [ ] Des connexions TCP
---

# TOR utilise le principe de :
- [ ] VPN classique
- [x] Routage en oignon
- [ ] Proxy simple
- [ ] Tunneling direct
---

# Tails est un système d'exploitation :
- [ ] Permanent
- [x] Amnésique (live)
- [ ] Windows-based
- [ ] Serveur
---

# Le protocole utilisé par défaut par nmap pour un scan de ports est :
- [x] TCP
- [ ] UDP
- [ ] ICMP
- [ ] ARP
---

# Quelle option nmap utilise des adresses IP leurres ?
- [ ] -f
- [x] -D
- [ ] -g
- [ ] -T
---

# Un pare-feu Stateful (SPI) bloque :
- [ ] Tous les paquets SYN
- [x] Les paquets ACK sans connexion établie
- [ ] Tous les paquets ICMP
- [ ] Les paquets avec TTL faible
---

# Netcat est souvent appelé :
- [ ] L'analyseur ultime
- [x] Le couteau suisse du réseau
- [ ] Le scanner parfait
- [ ] L'outil de pentest
---

# L'option nmap --script permet d'utiliser :
- [ ] Des scans plus rapides
- [x] Le Nmap Scripting Engine (NSE)
- [ ] Des proxies
- [ ] L'anonymat
---

# hping3 permet de :
- [x] Construire des paquets TCP/IP personnalisés
- [ ] Analyser le trafic réseau
- [ ] Casser des mots de passe
- [ ] Chiffrer les communications
---

# Un Idle Scan (zombie scan) utilise :
- [ ] L'IP de l'attaquant
- [x] L'IP d'une machine tierce
- [ ] Une IP aléatoire
- [ ] L'IP de la cible
---

---

# Explanations

# Question 1
Le champ "Protocol" dans l'en-tête IP utilise la valeur **6** pour indiquer TCP, **17** pour UDP, et **1** pour ICMP. Ce champ permet le démultiplexage vers le protocole approprié.

# Question 2
Le champ "Total Length" fait 16 bits, permettant une valeur maximale de 2^16 - 1 = **65535 octets** (en-tête + données).

# Question 3
Le Fragment Offset est exprimé en **unités de 8 octets** (64 bits). Cela permet de réassembler correctement les fragments.

# Question 4
**ARP (Address Resolution Protocol)** traduit une adresse IP en adresse MAC. RARP fait l'inverse (MAC → IP).

# Question 5
ARP fonctionne **uniquement sur le réseau local** car il utilise des trames broadcast au niveau liaison. Il n'est pas routable.

# Question 6
Type 8 = **Echo Request** (ping). Type 0 = Echo Reply.

# Question 7
Type 3 = Destination Unreachable. Code 3 = **Port Unreachable** (port UDP fermé).

# Question 8
La commande `arp -a` affiche le cache ARP contenant les correspondances IP ↔ MAC récentes.

# Question 9
UDP utilise le numéro de protocole **17** (0x11) dans l'en-tête IP.

# Question 10
L'en-tête UDP contient 4 champs : Source Port, Destination Port, Length, Checksum = **8 octets fixes**.

# Question 11
Établissement de connexion TCP : **SYN → SYN/ACK → ACK**.

# Question 12
Le champ Window Size indique le nombre d'octets que le récepteur peut recevoir, permettant le **contrôle de flux**.

# Question 13
Le flag **FIN** (Finish) indique la fin du flux de données d'un côté de la connexion.

# Question 14
/24 = 256 adresses - 2 (réseau + broadcast) = **254 hôtes utilisables**.

# Question 15
Les plages privées RFC 1918 : **10.0.0.0/8**, 172.16.0.0/12, 192.168.0.0/16.

# Question 16
Un attaquant passe **plus de 90% du temps** en phase de reconnaissance avant l'attaque réelle.

# Question 17
**Sublist3r** automatise la recherche de sous-domaines via multiples sources (Google, Bing, Netcraft, etc.).

# Question 18
CNN a surnommé Shodan **"Le moteur de recherche le plus terrifiant d'Internet"** car il révèle des objets IoT vulnérables.

# Question 19
La syntaxe correcte est `site:exemple.com filetype:pdf` pour trouver des fichiers PDF.

# Question 20
`intitle:` cherche dans les **titres de pages HTML** (balise `<title>`).

# Question 21
**FOCA** (Fingerprinting Organizations with Collected Archives) extrait les métadonnées des fichiers PDF, DOC, XLS, etc.

# Question 22
Le fichier robots.txt indique aux moteurs de recherche **quelles pages ne pas indexer**. Paradoxalement, c'est une mine d'or pour les attaquants.

# Question 23
`whois exemple.com` interroge les bases de données WHOIS pour obtenir les informations d'enregistrement du domaine.

# Question 24
Les enregistrements **MX (Mail Exchange)** indiquent les serveurs de messagerie du domaine.

# Question 25
`dig AXFR @ns1.exemple.com exemple.com` tente un **zone transfer** pour récupérer tous les enregistrements DNS.

# Question 26
**cewl** (Custom Word List generator) parcourt un site web et extrait les mots pour créer une wordlist.

# Question 27
**InSpy** est spécialisé pour collecter des informations depuis **LinkedIn** (technologies, profils, compétences).

# Question 28
**Dumpster diving** (fouille de poubelles) permet de trouver des documents sensibles non détruits.

# Question 29
theHarvester utilise **Google, Bing, LinkedIn, PGP, Shodan** et d'autres sources pour collecter emails et sous-domaines.

# Question 30
**Maltego** est décrit comme le **"couteau suisse" du footprinting** avec ses capacités de visualisation et transformations.

# Question 31
`nmap -sS` effectue un **TCP SYN scan** (half-open), plus furtif que le connect scan.

# Question 32
Le TCP connect scan (`-sT`) **complète le three-way handshake**, laissant des traces dans les logs.

# Question 33
Le **TCP SYN scan** (`-sS`) est le plus furtif car il ne complète pas la connexion.

# Question 34
Selon RFC 793, un port **ouvert** ne répond **pas** à un paquet FIN non sollicité.

# Question 35
Le Xmas Tree scan active les flags **FIN + URG + PSH** (tous les "bits s'allument").

# Question 36
`-O` active la **détection de système d'exploitation** par fingerprinting TCP/IP.

# Question 37
Linux utilise typiquement un **TTL initial de 64**.

# Question 38
Windows (XP/Vista/7/10/11) utilise un **TTL initial de 128**.

# Question 39
**p0f** effectue de la détection passive en analysant le trafic capturé sans envoyer de paquets.

# Question 40
**fping** envoie des pings **en parallèle** pour accélérer le balayage, contrairement au ping standard.

# Question 41
`-sU` scanne les **ports UDP** (lent car pas de ACK et timeouts).

# Question 42
Un scan UDP est **beaucoup plus lent** qu'un scan TCP en raison des timeouts et des limitations ICMP rate limiting.

# Question 43
`-T4` correspond au niveau **Aggressive** (scan rapide avec max scan delay de 10ms).

# Question 44
Le port **22** correspond au service **SSH** (Secure Shell).

# Question 45
Le port **443** correspond au service **HTTPS** (HTTP sécurisé par TLS/SSL).

# Question 46
traceroute utilise des **valeurs TTL incrémentales** (1, 2, 3...) pour découvrir le chemin réseau.

# Question 47
TOR utilise le **routage en oignon** (onion routing) avec chiffrement multi-couches.

# Question 48
**Tails** est un système d'exploitation **amnésique** qui tourne en mémoire vive et n'écrit rien sur le disque.

# Question 49
nmap scanne les ports **TCP** par défaut. Il faut `-sU` pour UDP.

# Question 50
`-D` utilise des **adresses IP leurres** pour masquer la vraie source du scan.

# Question 51
Un pare-feu **Stateful (SPI)** garde en mémoire les connexions établies et bloque les **paquets ACK sans connexion préalable**.

# Question 52
Netcat est appelé le **"couteau suisse" du réseau** pour sa polyvalence.

# Question 53
`--script` active le **NSE (Nmap Scripting Engine)** pour des fonctionnalités avancées (vuln, brute force, etc.).

# Question 54
**hping3** permet de **construire des paquets TCP/IP personnalisés** pour des tests avancés.

# Question 55
Un Idle Scan utilise l'**IP d'une machine tierce** (zombie) pour masquer l'origine du scan.

